var App={};function setNode(e,t,a){var i=document.getElementById(e.id),o=document.createElement(a),s=new Array;for(var n in t)if("object"==typeof t[n])for(var r in s[n]=new Array(Object.keys(t[n]).length),t[n])s[n][r]=t[n][r],o.setAttribute([r],s[n][r]);else if(s[n]=t[n],"text"==n){var l=document.createTextNode(s[n]);o.appendChild(l)}return i.appendChild(o),s}function search_item(e,t){for(var a in e)if(a==t)return e[a];return null}function resetCss(){$(".navbar #search_back").remove(),$(".navbar > *").css("display","block"),$(".ty-search").removeClass("full-width"),$(".navbar .user-navbar > li:first-child").prepend($(".ty-search"))}function notify(e,t,a=""){if("granted"!==Notification.permission)Notification.requestPermission();else var i=new Notification(e,{icon:"../../upload/57x57/rgb_logo.png",body:t});""!=a&&(i.onclick=function(){window.open(a)})}App.query=function(e,t,a,i,o=null){$.ajax({method:e,url:t,data:a,cache:i,success:o})},App.follow=function(e,t,a){$(e).click(function(){var e=$(".publisher-bar").attr("data-pub-text");App.query("get",t.url,t.data,a,function(t){t.result?($("#follow i").attr("class","fas fa-bell-slash"),$("#follow span").html("Smetti di seguire")):($("#follow i").attr("class","fas fa-bell"),$("#follow span").html("Inizia a seguire")),$(e).html(t.counter)})})},App.insl=function(e){var t=1;document.addEventListener("scroll",function(a){$(window).scrollTop()==$(document).height()-$(window).height()&&(t++,App.query("get","?page="+t,null,!1,function(t){$("#"+e).append(t.posts)}))})},App.loadData=function(e,t){App.query("get",t+1,null,!1,function(t){$(e).append(t.posts)})},App.upload=function(e){$(e).html("<div class='preview_body'><div class='image-wrapper' id='preview-wrapper'><img id='image_"+$(e).attr("id")+"' src="+URL.createObjectURL(event.target.files[0])+"></div></div>")},App.getUserInterface=function(e){for(var t in $(".__ui__g").remove(),$("body").css("overflow","hidden"),"undefined"!==event&&event.preventDefault(),e)var a=search_item(e[t],"header"),i=search_item(e[t],"data"),o=search_item(e[t],"title"),s=search_item(e[t],"content"),n=search_item(e[t],"done"),r=search_item(e[t],"styles");$("<div class='__ui__g'><div class='__ui__g_container'><div class='__ui__g_header'><div class='__ui__g_title'>"+o+"</div><div class='__ui__g_close'>&times;</div></div><div class='__ui__g_body'></div></div></div>").appendTo($("body")),null!=a&&$("<form action='"+a.action+"' method='"+a.method+"'><div class='__ui__g_form_control'></div></form>").appendTo($(".__ui__g_body"));var l=function(e){var t=e.class?"class='"+e.class+"'":"",a=e.id?"id="+e.id:"",i=e.name?"name="+e.name:"",o=e.value?"value="+e.value:"",s=e.type.length>1?"type="+e.type[1]:"",n=e.target?"target="+e.target:"",r=e.href?"href="+e.href:"",l=e.placeholder?"placeholder='"+e.placeholder+"'":"",c=e.required?"required":"",_=e.text?e.text:"";return"<"+e.type[0]+" "+a+" "+r+" "+t+" "+s+" "+o+" "+i+" "+l+" "+c+" "+n+">"+_+"</"+e.type[0]+">"};for(var t in s)if("object"==typeof s[t].type[0]){var c=s[t].type[0].select;$("<div class='form-group'><select id='"+s[t].name+"' class='"+s[t].class+"' name='"+s[t].name+"'></select></div>").appendTo($("div").hasClass("__ui__g_form_control")?$(".__ui__g_form_control"):$(".__ui__g_body"));for(var _ in c)$(".__ui__g_form_control select").append("<option value='"+c[_].value+"'>"+c[_].text+"</option>")}else s[t].label=s[t].label?"<label>"+s[t].label+"</label>":"",a?$("<div class='form-group'>"+l(s[t])+s[t].label).appendTo($("div").hasClass("__ui__g_form_control")?$(".__ui__g_form_control"):$(".__ui__g_body")):$(l(s[t])+s[t].label).appendTo($("div").hasClass("__ui__g_form_control")?$(".__ui__g_form_control"):$(".__ui__g_body"));r&&this.setUIStyle(r,".__ui__g .__ui__g_body a"),$(".__ui__g_header .__ui__g_close").click(function(){$(".__ui__g").remove(),$("body").css("overflow","auto")}),$("form").on("submit",function(e){for(var t in e.preventDefault(),i)!$.isNumeric(i[t])&&(i[t]=$(i[t]).val());App.query(a.method,a.action,i,!1,n)})},App.setUIStyle=function(e,t){for(var a in e)$(t).css(a,e[a])},App.update=function(){$(".ty-search button#search").click(function(){if($(window).width()<1004){if(!$(".ty-search").hasClass("full-width")){$(".navbar > *").css("display","none"),$(".ty-search").addClass("full-width");$(".ty-search").appendTo($(".navbar")),$("<span id='search_back' class='fa fa-arrow-left' style='margin: 9px 5px 0 0;cursor:pointer'></span>").insertBefore($(".ty-search input"))}$(".navbar #search_back").click(function(){resetCss()})}}),$(window).width()>=1004&&$(".ty-search").hasClass("full-width")&&resetCss()},App.info=function(){$("*[data-script=info]").each(function(){$(this).css("cursor","pointer"),$(this).on("click",function(){$(this).children().hasClass("info-box")?$(this).children().remove():$("<div class='info-box'>"+$(this).data("text")+"</div>").appendTo($(this))})})},App.share=function(e){var t={facebook:["fa-facebook","https://www.facebook.com/share.php?u="],linkedin:["fa-linkedin","https://www.linkedin.com/sharing/share-offsite/?url="]};$(e.appendTo).click(function(){event.preventDefault(),$(this).hasClass("sb-open")?($(this).next(".sb-dialog").remove(),$(this).removeClass("sb-open")):($(this).addClass("sb-open"),$("<div class='sb-dialog'></div>").insertAfter($(this)),$.each(e.apps,function(a){$("<a href='"+t[e.apps[a]][1]+window.location.href+"'><div class='fab "+t[e.apps[a]][0]+"'></div></a>").appendTo($(".sb-dialog"))}))})};
