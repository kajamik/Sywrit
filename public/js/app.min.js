var App={};function setNode(e,i,a){var t=document.getElementById(e.id),o=document.createElement(a),s=new Array;for(var n in i)if("object"==typeof i[n])for(var r in s[n]=new Array(Object.keys(i[n]).length),i[n])s[n][r]=i[n][r],o.setAttribute([r],s[n][r]);else if(s[n]=i[n],"text"==n){var l=document.createTextNode(s[n]);o.appendChild(l)}return t.appendChild(o),s}function search_item(e,i){for(var a in e)if(a==i)return e[a];return null}function resetCss(){$(".navbar #search_back").remove(),$(".navbar > *").css("display","block"),$(".ty-search").removeClass("full-width"),$(".navbar .user-navbar > li:first-child").prepend($(".ty-search"))}function notify(e,i,a=""){if("granted"!==Notification.permission)Notification.requestPermission();else var t=new Notification(e,{icon:"../../upload/57x57/rgb_logo.png",body:i});""!=a&&(t.onclick=function(){window.open(a)})}App.query=function(e,i,a,t,o=null){$.ajax({method:e,url:i,data:a,cache:t,success:o})},App.follow=function(e,i,a){$(e).click(function(){var e=$(".publisher-bar").attr("data-pub-text");App.query("get",i.url,i.data,a,function(i){i.result?($("#follow i").attr("class","fas fa-bell-slash"),$("#follow span").html("Smetti di seguire")):($("#follow i").attr("class","fas fa-bell"),$("#follow span").html("Inizia a seguire")),$(e).html(i.counter)})})},App.insl=function(e){var i=1;document.addEventListener("scroll",function(){$(window).scrollTop()==$(document).height()-$(window).height()&&(i++,App.query("get","?page="+i,null,!1,function(i){$("#"+e).append(i.posts)}))})},App.loadData=function(e,i){App.query("get",i+1,null,!1,function(i){$(e).append(i.posts)})},App.upload=function(e){$(e).html("<div class='preview_body'><div class='image-wrapper' id='preview-wrapper'><img id='image_"+$(e).attr("id")+"' src="+URL.createObjectURL(event.target.files[0])+"></div></div>")},App.getUserInterface=function(e,i=!1,a){for(var t in $(".__ui__g").remove(),$("body").css("overflow","hidden"),e)var o=search_item(e[t],"header"),s=search_item(e[t],"data"),n=search_item(e[t],"title"),r=search_item(e[t],"content"),l=search_item(e[t],"done"),c=search_item(e[t],"styles");$("<div class='__ui__g'><div class='__ui__g_container'><div class='__ui__g_header'><div class='__ui__g_title'>"+n+"</div><div class='__ui__g_close'>&times;</div></div><div class='__ui__g_body'></div></div></div>").appendTo($("body")),null!=o&&$("<form action='"+o.action+"' method='"+o.method+"'><div class='__ui__g_form_control'></div></form>").appendTo($(".__ui__g_body"));var _=function(e){var i=e.class?"class='"+e.class+"'":"",a=e.id?"id="+e.id:"",t=e.name?"name="+e.name:"",o=e.value?"value="+e.value:"",s=e.type.length>1?"type="+e.type[1]:"",n=e.target?"target="+e.target:"",r=e.href?"href="+e.href:"",l=e.placeholder?"placeholder='"+e.placeholder+"'":"",c=e.required?"required":"",_=e.text?e.text:"";return"<"+e.type[0]+" "+a+" "+r+" "+i+" "+s+" "+o+" "+t+" "+l+" "+c+" "+n+">"+_+"</"+e.type[0]+">"};if("string"==typeof r)$(".__ui__g_body").append(r);else for(var t in r)if("object"==typeof r[t].type[0]){var d=r[t].type[0].select;$("<div class='form-group'><select id='"+r[t].name+"' class='"+r[t].class+"' name='"+r[t].name+"'></select></div>").appendTo($("div").hasClass("__ui__g_form_control")?$(".__ui__g_form_control"):$(".__ui__g_body"));for(var p in d)$(".__ui__g_form_control select").append("<option value='"+d[p].value+"'>"+d[p].text+"</option>")}else r[t].label=r[t].label?"<label>"+r[t].label+"</label>":"",o?$("<div class='form-group'>"+_(r[t])+r[t].label).appendTo($("div").hasClass("__ui__g_form_control")?$(".__ui__g_form_control"):$(".__ui__g_body")):$(_(r[t])+r[t].label).appendTo($("div").hasClass("__ui__g_form_control")?$(".__ui__g_form_control"):$(".__ui__g_body"));c&&this.setUIStyle(c,".__ui__g .__ui__g_body a"),$(".__ui__g_header .__ui__g_close").click(function(){$(".__ui__g").remove(),$("body").css("overflow","auto")}),$("form").on("submit",function(e){for(var a in 0==i&&e.preventDefault(),s)!$.isNumeric(s[a])&&(s[a]=$(s[a]).val());App.query(o.method,o.action,s,!1,l)})},App.setUIStyle=function(e,i){for(var a in e)$(i).css(a,e[a])},App.update=function(){$(".ty-search button#search").click(function(){if($(window).width()<1004){if(!$(".ty-search").hasClass("full-width")){$(".navbar > *").css("display","none"),$(".ty-search").addClass("full-width");$(".ty-search").appendTo($(".navbar")),$("<span id='search_back' class='fa fa-arrow-left' style='margin: 9px 5px 0 0;cursor:pointer'></span>").insertBefore($(".ty-search input"))}$(".navbar #search_back").click(function(){resetCss()})}}),$(window).width()>=1004&&$(".ty-search").hasClass("full-width")&&resetCss()},App.info=function(){$("*[data-script=info]").each(function(){$(this).css("cursor","pointer"),$(this).on("click",function(){$(this).children().hasClass("info-box")?$(this).children().remove():$("<div class='info-box'>"+$(this).data("text")+"</div>").appendTo($(this))})})},App.share=function(e){var i={facebook:["fa-facebook","https://www.facebook.com/share.php?u="],linkedin:["fa-linkedin","https://www.linkedin.com/sharing/share-offsite/?url="]};$(e.appendTo).click(function(){$(this).hasClass("sb-open")?($(this).children(".sb-dialog").remove(),$(this).removeClass("sb-open")):($(this).addClass("sb-open"),$("<div class='sb-dialog'></div>").appendTo($(this)),$.each(e.apps,function(a){$("<a href='"+i[e.apps[a]][1]+window.location.href+"'><div class='fab "+i[e.apps[a]][0]+"'></div></a>").appendTo($(".sb-dialog"))}))})};
